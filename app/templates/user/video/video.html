<div class="d-flex justify-content-center align-items-center vh-100 bg-light">
    <!-- Left region for new features (5 buttons) -->
    <div class="d-flex flex-column justify-content-center me-4"> <!-- space-y-8 increases space between buttons -->
        <!-- Button Like -->
        <div class="d-flex flex-column align-items-center mb-4">
            <button id="like-button"
                    {% if session['user'] %}
                    onclick="video_like('{{ session['user']['id'] }}')"
                    {% else %}
                    data-bs-toggle="modal" data-bs-target="#login-popup"
                    {% endif %}
                    class="btn btn-light rounded-circle shadow-sm p-3">
                {# <button id="like-button" class="btn btn-light rounded-circle shadow-sm p-3"> <!-- w-30 h-30 increases button size -->#}
                <i class="bi bi-hand-thumbs-up"></i>
            </button>
            <span id="like-count" class="small mt-1">1</span> <!-- Initial like count -->
        </div>

        <!-- Button Dislike -->
        <div class="d-flex flex-column align-items-center mb-4">
            <button id="dislike-button"
                    {% if session['user'] %}
                    onclick="dislike()"
                    {% else %}
                    data-bs-toggle="modal" data-bs-target="#login-popup"
                    {% endif %}
                    class="btn btn-light rounded-circle shadow-sm p-3">
                {# <button id="dislike-button" class="btn btn-light rounded-circle shadow-sm p-3"> <!-- w-30 h-30 increases button size -->#}
                <i class="bi bi-hand-thumbs-down"></i>
            </button>
            <span id="dislike-count" class="text-sm"></span> <!-- Initial comment count -->
        </div>
        <!-- Button Comment -->
        <div class="d-flex flex-column align-items-center mb-4">
            <i class="bi bi-chat-right-text"></i>
            <span id="comment-count" class="text-sm"></span> <!-- Initial comment count -->
        </div>

        <!-- Button Share -->
        <div class="d-flex flex-column align-items-center mb-4">
            <button id="share-button" class="btn btn-light rounded-circle shadow-sm p-3" data-bs-toggle="modal" data-bs-target="#shareModal">
                <i class="bi bi-share-fill"></i>
            </button>
            {% include 'user/video/modal/share.html' %}
        </div>
        <!-- Button setting -->
        <div class="dropdown">
            <button id="settings-button" class="btn btn-light rounded-circle shadow-sm p-3 dropdown-toggle" data-bs-toggle="modal" data-bs-target="#settingsModal" aria-expanded="false">
                <i class="bi bi-gear"></i>
            </button>
        </div>
        {% include 'user/video/modal/setting.html' %}
    </div>

    <!-- Video Section (Centered) -->
    <div class="position-relative bg-white shadow rounded overflow-hidden d-flex flex-column align-items-center mb-4"
         style="width: 30%; height: 80%;">
        <!-- Video Container -->
        <div class="position-relative w-100 h-100">
            <iframe id="video-player" class="position-relative w-100 h-100" src=""
                    title="YouTube video player" frameborder="0" allow="accelerometer; autoplay;
                clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen>

            </iframe>
        </div>
    </div>

    <!-- Comment Section (Centered) -->
    <div id="comment-section" class="position-relative bg-white shadow rounded d-flex flex-column align-items-center mb-4"
         style="width: 30%; height: 80%; background-color: #f8f9fa;">
        <!-- Comment Container -->
        <div class="position-relative w-100 h-100 p-3 overflow-auto">
            <h5>Bình luận</h5>
            <div id="comment-container"></div>
            {#            <ul id="comment-list" class="list-unstyled">#}
            {#                <li class="comment-item mb-3">#}
            {#                    <div class="d-flex justify-content-between">#}
            {#                        <!-- Nội dung bình luận -->#}
            {#                        <p class="comment-content">Nội dung của bình luận</p>#}
            {#                        <ul class="dropdown-menu" id="editDeleteMenu">#}
            {#                            <li><a class="dropdown-item" href="#" onclick="editComment('comment-id-placeholder')">Chỉnh sửa</a></li>#}
            {#                            <li><a class="dropdown-item" href="#" onclick="deleteComment('comment-id-placeholder')">Xoá</a></li>#}
            {#                        </ul>#}
            {#                    </div>#}
            {#                </li>#}
            {#            </ul>#}
        </div>

        <!-- Input area for new comment (fixed at the bottom) -->
        <div class="input-group" style="position: absolute; bottom: 0; left: 0; width: 100%; padding: 10px; background-color: #f8f9fa;">
            <input id="comment-input" type="text" class="form-control" placeholder="Nhập bình luận..." aria-label="Nhập bình luận">
            {#            <button id="send-comment" class="btn btn-primary" type="button" onclick="insertComment()">Gửi</button>#}
            <button id="send-comment" class="btn btn-primary" type="button">Gửi</button>

        </div>
    </div>

    <!-- Buttons for navigating videos (outside the video, on the right) -->
    <div class="d-flex flex-column ms-4" style="gap: 2rem;">
        <button id="prev-button" class="btn btn-light rounded-circle shadow-sm p-3">
            <i class="bi bi-arrow-up"></i>
        </button>
        <button id="next-button" class="btn btn-light rounded-circle shadow-sm p-3">
            <i class="bi bi-arrow-down"></i>
        </button>
    </div>

    <!-- Description Section (Similar to Comment Section) -->
    <div id="description-section" class="position-relative bg-white shadow rounded overflow-hidden d-flex flex-column align-items-center mb-4 d-none"
         style="width: 30%; height: 80%; background-color: #f8f9fa;">
        <!-- Button Close ("X") -->
        <button id="close-description" class="btn-close position-absolute top-0 end-0 m-3" aria-label="Close"></button>
        <!-- Description Container -->
        <div id="description-container" class="position-relative w-100 h-100 p-3 overflow-auto">
            <!-- Video title -->
            <h5 id="video-title" class="fw-bold mb-4">Nội dung mô tả</h5>

            <!-- Thông tin số liệu -->
            <div class="d-flex justify-content-around text-center mb-4">
                <!-- Lượt thích -->
                <div>
                    <div class="fs-2 fw-bold" id="like-count-description">0</div>
                    <div class="text-muted small">Lượt thích</div>
                </div>
                <!-- Số bình luận -->
                <div>
                    <div class="fs-2 fw-bold" id="comment-count-description">0</div>
                    <div class="text-muted small">Số bình luận</div>
                </div>
                <!-- Người đăng -->
                <div>
                    <div class="fs-5 fw-bold" id="uploader">Người đăng</div>
                    <div class="text-muted small">Người đăng</div>
                </div>
            </div>
        </div>

    </div>
    <!-- Modal structure -->
    <!-- Modal cho nút Lưu vào danh sách phát -->
    <div class="modal fade" id="saveToPlaylistModal" tabindex="-1" aria-labelledby="saveToPlaylistLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal header -->
                <div class="modal-header">
                    <h5 class="modal-title" id="saveToPlaylistLabel">Lưu vào danh sách phát</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Modal body -->
                <div class="modal-body p-0">
                    <!-- Danh sách các playlist -->
                    <div class="list-group">
                        <!-- Mẫu cho một playlist -->
                        {% for playlist in playlists %}
                            <label class="list-group-item d-flex align-items-center">
                                <input class="form-check-input me-3" type="checkbox" value="{{ playlist.id }}" {% if playlist.contains_video %}checked{% endif %}/>
                                <div class="flex-grow-1">
                                    <div>{{ playlist.name }}</div>
                                    {% if playlist.is_private %}
                                        <small class="text-muted">Riêng tư</small>
                                    {% else %}
                                        <small class="text-muted">Công khai</small>
                                    {% endif %}
                                </div>
                                <i class="bi bi-lock-fill ms-auto"></i>
                            </label>
                        {% endfor %}
                    </div>
                    <!-- Nút tạo playlist mới -->
                    <div class="d-flex justify-content-center my-3">
                        <button id="addNewPlaylist" class="btn btn-outline-secondary w-100" data-bs-toggle="modal" data-bs-target="#createPlaylistModal">
                            + Danh sách phát mới
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal tạo playlist mới -->
    <div class="modal fade" id="createPlaylistModal" tabindex="-1" aria-labelledby="createPlaylistLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal header -->
                <div class="modal-header">
                    <h5 class="modal-title" id="createPlaylistLabel">Tạo danh sách phát mới</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <!-- Tiêu đề playlist -->
                    <div class="mb-3">
                        <label for="playlistTitle" class="form-label">Tiêu đề</label>
                        <input type="text" class="form-control" id="playlistTitle" placeholder="Nhập tiêu đề">
                    </div>
                    <!-- Quyền riêng tư -->
                    <div class="mb-3">
                        <label class="form-label">Quyền riêng tư</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="privacyOptions" id="privacyPublic" value="public" checked>
                            <label class="form-check-label d-flex justify-content-between align-items-center" for="privacyPublic">
                                Công khai
                                <i class="bi bi-globe fs-5"></i>
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="privacyOptions" id="privacyPrivate" value="private">
                            <label class="form-check-label d-flex justify-content-between align-items-center" for="privacyPrivate">
                                Riêng tư
                                <i class="bi bi-lock-fill fs-5"></i>
                            </label>
                        </div>
                    </div>

                    <!-- Nút tạo -->
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Hủy</button>
                        <button type="button" class="btn btn-primary" id="createPlaylistButton">Tạo</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal thông báo Phụ đề -->
    <div class="modal fade" id="subtitleModal" tabindex="-1" aria-labelledby="subtitleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal header -->
                <div class="modal-header">
                    <h5 class="modal-title" id="subtitleModalLabel">Phụ đề</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    Video này không có phụ đề.
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Báo vi phạm -->
    <div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal header -->
                <div class="modal-header">
                    <h5 class="modal-title" id="reportModalLabel">Báo video vi phạm</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <form id="reportForm">
                        <!-- Danh sách lý do vi phạm -->
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason1" value="Nội dung khiêu dâm" required>
                                <label class="form-check-label" for="reason1">
                                    Nội dung khiêu dâm
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason2" value="Nội dung bạo lực hoặc phản cảm" required>
                                <label class="form-check-label" for="reason2">
                                    Nội dung bạo lực hoặc phản cảm
                                </label>
                            </div>
                            <!-- Thêm các lý do khác tương tự -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason3" value="Nội dung lăng mạ hoặc kích động thù hận" required>
                                <label class="form-check-label" for="reason3">
                                    Nội dung lăng mạ hoặc kích động thù hận
                                </label>
                            </div>
                            <!-- ... (tiếp tục cho đến lý do cuối cùng) -->
                            <!-- Ví dụ cho các lý do còn lại -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason4" value="Nội dung quấy rối hoặc bắt nạt" required>
                                <label class="form-check-label" for="reason4">
                                    Nội dung quấy rối hoặc bắt nạt
                                </label>
                            </div>
                            <!-- Tiếp tục cho các lý do khác -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason5" value="Hành động gây hại hoặc nguy hiểm" required>
                                <label class="form-check-label" for="reason5">
                                    Hành động gây hại hoặc nguy hiểm
                                </label>
                            </div>
                            <!-- Thêm các lý do còn lại -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason6" value="Thông tin sai lệch" required>
                                <label class="form-check-label" for="reason6">
                                    Thông tin sai lệch
                                </label>
                            </div>
                            <!-- ... và tiếp tục cho đến hết danh sách -->
                            <!-- Ví dụ các lý do cuối cùng -->
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason7" value="Nội dung liên quan đến việc ngược đãi trẻ em" required>
                                <label class="form-check-label" for="reason7">
                                    Nội dung liên quan đến việc ngược đãi trẻ em
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason8" value="Nội dung quảng bá chủ nghĩa khủng bố" required>
                                <label class="form-check-label" for="reason8">
                                    Nội dung quảng bá chủ nghĩa khủng bố
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason9" value="Nội dung gian lận/vi phạm hoặc gây hiểu lầm" required>
                                <label class="form-check-label" for="reason9">
                                    Nội dung gian lận/vi phạm hoặc gây hiểu lầm
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason10" value="Vấn đề pháp lý" required>
                                <label class="form-check-label" for="reason10">
                                    Vấn đề pháp lý
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="violationReason" id="reason11" value="Phụ đề có vấn đề" required>
                                <label class="form-check-label" for="reason11">
                                    Phụ đề có vấn đề
                                </label>
                            </div>
                        </div>
                        <!-- Thông báo xác nhận (ẩn ban đầu) -->
                        <div id="reportConfirmation" class="alert alert-success d-none" role="alert">
                            Video đã được báo vi phạm.
                            <br>
                            Nội dung vi phạm: <span id="selectedReason"></span>
                        </div>
                    </form>
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-danger" id="submitReportButton">Báo vi phạm</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Feedback Section (Initially hidden) -->
    <div id="feedback-section" class="position-relative bg-white shadow rounded overflow-hidden d-flex flex-column align-items-start p-4 mb-4 d-none"
         style="width: 30%; height: 80%; background-color: #f8f9fa; position: fixed; right: 0; top: 10%; z-index: 1050;">
        <!-- Button Close ("X") -->
        <button id="close-feedback" class="btn-close position-absolute top-0 end-0 m-3" aria-label="Close"></button>

        <!-- Feedback Content -->
        <h5 class="mb-3">Gửi phản hồi đến YouTube</h5>
        <div class="mb-3">
            <label for="feedback-text" class="form-label">Mô tả ý kiến phản hồi của bạn:</label>
            <textarea id="feedback-text" class="form-control" rows="5" placeholder="Hãy cho chúng tôi biết điều gì khiến bạn đưa ra ý kiến phản hồi này"></textarea>
        </div>
        <!-- Optional screenshot button -->
        <div class="mb-3">
            <label class="form-label">Ảnh chụp màn hình sẽ giúp chúng tôi hiểu rõ hơn về ý kiến phản hồi của bạn. (không bắt buộc)</label>
            <button id="screenshot-button" class="btn btn-secondary">Chụp ảnh màn hình</button>
        </div>
        <!-- Informational text -->
        <div class="mb-3 text-muted" style="font-size: 0.9em;">
            Một số thông tin về tài khoản và hệ thống có thể được gửi đến Google. Chúng tôi sẽ sử dụng thông tin đó để khắc phục vấn đề và cải thiện dịch vụ, theo <a href="#">Chính sách quyền riêng tư</a> và <a href="#">Điều khoản dịch vụ</a> của chúng tôi. Có thể chúng tôi sẽ email cho bạn khi có thông tin khác hoặc nội dung cập nhật. Hãy truy cập trang <a href="#">Trợ giúp về Pháp lý</a> để yêu cầu thay đổi nội dung vì lý do pháp lý.
        </div>
        <!-- Send button -->
        <button id="send-feedback-button" class="btn btn-primary">Gửi</button>

        <!-- Thank you message (Initially hidden) -->
        <div id="feedback-thank-you" class="mt-3 alert alert-success d-none" role="alert">
            Cảm ơn bạn đã phản hồi.
        </div>
    </div>


</div>

<script>
    let sessionUser = {
        id: null
    };
    {% if session['user'] %}
        sessionUser = {{ session['user']|tojson }};
        sessionId = sessionUser.id.toString();
    {% endif %}
</script>

<script src="/static/js/user/video/video_variable.js"></script>
<script src="/js/user/video/video_like_toggle_button.js"></script>
<script src="/static/js/user/video/video_button_add_event.js"></script>
<script src="/static/js/user/video/video_comment_render.js"></script>
<script src="/static/js/user/video/video_comment_function.js"></script>
<script src="/static/js/user/video/video_comment_add_event.js"></script>
<script src="/static/js/user/video/video_player.js"></script>